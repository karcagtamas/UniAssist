@using UniAssist.Services
@using UniAssist.Enums
@inject IThemeService ThemeService
@inject StoreService StoreService

<MatSlideToggle TValue="bool" ValueChanged="ThemeChange"></MatSlideToggle>

@code {
    private ThemeType ThemeType { get; set; }
    private bool IsDark { get; set; }

    protected override void OnInitialized()
    {
        base.OnInitialized();
        this.UpdateTheme();
        this.IsDark = this.ThemeType == ThemeType.Dark;
        this.StoreService.OnChange += UpdateTheme;
    }

    private async void ThemeChange(bool value)
    {
        await this.ThemeService.SetTheme(value ? ThemeType.Dark : ThemeType.Light);
    }

    private void UpdateTheme()
    {
        this.ThemeType = this.StoreService.GetTheme();
    }
}